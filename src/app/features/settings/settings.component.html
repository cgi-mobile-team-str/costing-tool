<div class="container ps-container">
  <div class="header">
    <div>
      <span class="context-label">{{ 'nav.settings' | translate }}</span>
      <h2>{{ settings().projectName }}</h2>
    </div>
  </div>

  <form [formGroup]="form" (ngSubmit)="save()">
    <div class="card">
      <h3>{{ 'settings.project_section' | translate }}</h3>
      <div class="form-group">
        <label>{{ 'settings.project_name' | translate }}</label>
        <input type="text" formControlName="projectName" class="form-control" />
      </div>
    </div>

    <div class="card">
      <h3>{{ 'settings.calculations_section' | translate }}</h3>

      <div class="form-group">
        <label>{{ 'settings.currency' | translate }}</label>
        <select formControlName="currency" class="form-control">
          <option value="EUR">EUR (€)</option>
          <option value="USD">USD ($)</option>
        </select>
      </div>
    </div>

    <div class="card">
      <h3>{{ 'settings.interface_section' | translate }}</h3>
      <div class="form-group">
        <label>{{ 'settings.language' | translate }}</label>
        <select [value]="currentLang()" (change)="changeLang($event)" class="form-control">
          <option value="fr">Français</option>
          <option value="en">English</option>
        </select>
      </div>
    </div>

    <div class="actions">
      <button type="submit" [disabled]="form.invalid || form.pristine" z-button>
        {{ 'common.save' | translate }}
      </button>
    </div>
  </form>

  <div class="card card-mt">
    <h3>{{ 'settings.data_section' | translate }}</h3>
    <p class="hint hint-mb">
      {{ 'settings.data_hint' | translate }}
    </p>
    <div class="data-actions">
      <input
        type="file"
        #fileInput
        class="hidden-input"
        (change)="importJson($event)"
        accept=".json"
      />
      <button (click)="fileInput.click()" z-button zType="secondary">
        {{ 'settings.import_json' | translate }}
      </button>
      <button (click)="exportJson()" z-button zType="secondary">
        {{ 'settings.export_json' | translate }}
      </button>
    </div>
  </div>

  <div class="danger-zone">
    <h3>{{ 'settings.danger_zone' | translate }}</h3>
    <button (click)="resetApp()" z-button zType="destructive">
      {{ 'settings.reset_app' | translate }}
    </button>
  </div>

  @if (showImportModal()) {
  <app-import-modal
    [itemCount]="itemsToImport().length"
    [projectName]="importedProjectName()"
    (action)="handleImportAction($event)"
  />
  }
</div>
